prompts.chat provides a Model Context Protocol (MCP) server, enabling AI assistants to access prompts directly. This chapter covers MCP setup and usage.

## What is MCP?

The Model Context Protocol (MCP) is a standard for connecting AI systems with external tools and data sources. With MCP, AI assistants can:

- Search and retrieve prompts
- Use prompts directly in conversations
- Save prompts from conversations
- Access prompt variables and metadata

## MCP Server Overview

prompts.chat exposes an MCP server at `/api/mcp` with:

**Tools:**
- `search_prompts` — Search the prompt library
- `get_prompt` — Retrieve a specific prompt
- `save_prompt` — Save new prompts (authenticated)
- `improve_prompt` — Enhance prompts with AI (authenticated)

**Prompts (MCP Prompts):**
- All public prompts available as MCP prompts
- Variable substitution support
- Pagination for large libraries

## Setting Up MCP

### For Claude Desktop

Add to your Claude Desktop configuration (`claude_desktop_config.json`):

```json
{
  "mcpServers": {
    "prompts-chat": {
      "command": "npx",
      "args": ["-y", "prompts.chat"],
      "env": {
        "PROMPTS_API_KEY": "your-api-key-here"
      }
    }
  }
}
```

### For Other MCP Clients

Connect to the HTTP endpoint:

```
Endpoint: https://prompts.chat/api/mcp
Method: POST
Headers:
  Content-Type: application/json
  PROMPTS_API_KEY: your-api-key (optional, for authenticated features)
```

### Self-Hosted Instance

```json
{
  "mcpServers": {
    "my-prompts": {
      "command": "npx",
      "args": ["-y", "prompts.chat"],
      "env": {
        "PROMPTS_BASE_URL": "https://your-instance.com",
        "PROMPTS_API_KEY": "your-api-key"
      }
    }
  }
}
```

## Using MCP Tools

### search_prompts

Search the prompt library:

```typescript
// Tool call
{
  "name": "search_prompts",
  "arguments": {
    "query": "code review python",
    "limit": 10,
    "type": "TEXT",
    "category": "development",
    "tag": "code-review"
  }
}

// Response
{
  "query": "code review python",
  "count": 3,
  "prompts": [
    {
      "id": "abc123",
      "slug": "python-code-reviewer",
      "title": "Python Code Reviewer",
      "description": "Reviews Python code for best practices",
      "content": "You are an expert Python developer...",
      "type": "TEXT",
      "author": "username",
      "category": "Development",
      "tags": ["python", "code-review"],
      "votes": 42,
      "createdAt": "2024-01-15T..."
    }
  ]
}
```

### get_prompt

Retrieve a specific prompt with variable filling:

```typescript
// Tool call
{
  "name": "get_prompt",
  "arguments": {
    "id": "abc123"
  }
}

// If prompt has variables, MCP elicitation requests values
// Response after filling
{
  "id": "abc123",
  "title": "Python Code Reviewer",
  "content": "You are an expert Python developer reviewing code...",
  "originalContent": "You are an expert \${language} developer...",
  "variables": {
    "language": "Python"
  },
  "link": "https://prompts.chat/prompts/abc123"
}
```

### save_prompt (Authenticated)

Save a new prompt to your account:

```typescript
// Tool call
{
  "name": "save_prompt",
  "arguments": {
    "title": "My Custom Prompt",
    "content": "You are a helpful assistant that...",
    "description": "A prompt for general assistance",
    "tags": ["general", "assistant"],
    "category": "productivity",
    "isPrivate": true,
    "type": "TEXT"
  }
}

// Response
{
  "success": true,
  "prompt": {
    "id": "new-id",
    "slug": "my-custom-prompt",
    "title": "My Custom Prompt",
    "isPrivate": true,
    "link": null  // null because private
  }
}
```

### improve_prompt (Authenticated)

Enhance a basic prompt using AI:

```typescript
// Tool call
{
  "name": "improve_prompt",
  "arguments": {
    "prompt": "Help me write better code",
    "outputType": "text",
    "outputFormat": "text"
  }
}

// Response
{
  "original": "Help me write better code",
  "improved": "You are a senior software engineer and code mentor...",
  "outputType": "text",
  "outputFormat": "text",
  "inspirations": [
    {
      "id": "xyz789",
      "slug": "code-mentor",
      "title": "Code Mentor",
      "similarity": 78
    }
  ],
  "model": "gpt-4"
}
```

## Using MCP Prompts

### Listing Available Prompts

MCP clients can list all available prompts:

```typescript
// MCP prompts/list request
{
  "method": "prompts/list",
  "params": {
    "cursor": "1"  // Pagination
  }
}

// Response
{
  "prompts": [
    {
      "name": "python-code-reviewer",
      "title": "Python Code Reviewer",
      "description": "Reviews Python code",
      "arguments": [
        {
          "name": "code",
          "description": "Code to review",
          "required": true
        }
      ]
    }
  ],
  "nextCursor": "2"
}
```

### Using a Prompt

```typescript
// MCP prompts/get request
{
  "method": "prompts/get",
  "params": {
    "name": "python-code-reviewer",
    "arguments": {
      "code": "def add(a, b): return a + b"
    }
  }
}

// Response with filled prompt
{
  "description": "Reviews Python code",
  "messages": [
    {
      "role": "user",
      "content": {
        "type": "text",
        "text": "You are an expert Python developer. Review this code:\n\ndef add(a, b): return a + b"
      }
    }
  ]
}
```

## Filtering Prompts

### URL Parameters

Filter prompts exposed via MCP:

```
/api/mcp?categories=development,productivity
/api/mcp?tags=python,code-review
/api/mcp?users=username1,username2
```

### Combined Filtering

```json
{
  "mcpServers": {
    "dev-prompts": {
      "command": "npx",
      "args": [
        "-y", "prompts.chat",
        "--categories", "development",
        "--tags", "python,typescript"
      ]
    }
  }
}
```

## Authentication

### Getting an API Key

1. Log into prompts.chat
2. Go to Settings → API
3. Generate new API key
4. Copy and store securely

### API Key Usage

```bash
# Environment variable
export PROMPTS_API_KEY=your-key-here

# Or in MCP config
{
  "env": {
    "PROMPTS_API_KEY": "your-key-here"
  }
}
```

### Authenticated vs. Unauthenticated

| Feature | No API Key | With API Key |
|---------|------------|--------------|
| search_prompts | ✓ Public only | ✓ + Your private |
| get_prompt | ✓ Public only | ✓ + Your private |
| save_prompt | ✗ | ✓ |
| improve_prompt | ✗ | ✓ |
| MCP prompts | ✓ Public only | ✓ + Your private |

## Privacy Settings

### Public vs. Private by Default

In your prompts.chat settings, configure:
- **MCP prompts public by default**: New prompts saved via MCP are public
- **MCP prompts private by default**: New prompts saved via MCP are private

### Per-Prompt Privacy

```typescript
// Save as private
{
  "name": "save_prompt",
  "arguments": {
    "title": "My Secret Prompt",
    "content": "...",
    "isPrivate": true  // Override default
  }
}
```

## Real-World Usage Examples

### In Claude Conversation

```
User: I need to review some Python code. Can you help?

Claude: I can help with that. Let me search for a code review prompt.

[Calls search_prompts with query "python code review"]

I found several code review prompts. The "Python Code Reviewer" prompt 
looks suitable. Would you like me to use it?

User: Yes, please review this code: [code]

Claude: [Uses get_prompt to load the prompt, then applies it to review the code]

Based on the Python Code Reviewer prompt, here's my analysis:
[Detailed code review]
```

### Saving Prompts from Conversation

```
User: That prompt you just helped me create works great. 
      Can you save it to my prompts.chat account?

Claude: [Calls save_prompt with the prompt content]

I've saved "Custom Analysis Prompt" to your prompts.chat account. 
You can find it in your profile or access it in future conversations 
via MCP.
```

### Improving Prompts

```
User: I have this basic prompt: "Help me write emails"
      Can you improve it?

Claude: [Calls improve_prompt]

Here's an enhanced version of your prompt:

"You are a professional communication specialist with expertise in 
business correspondence. Help compose emails that are clear, 
professional, and achieve their intended purpose..."

This improved version adds:
- Defined role and expertise
- Clear success criteria
- Context awareness

Would you like me to save this improved version?
```

## Troubleshooting

### Common Issues

**MCP server not connecting:**
```
- Check endpoint URL is correct
- Verify API key if using authenticated features
- Check network/firewall settings
- Review MCP client logs
```

**Prompts not appearing:**
```
- Ensure prompts are public (or using API key for private)
- Check category/tag filters
- Verify the instance URL
```

**Save failing:**
```
- API key required for save_prompt
- Check API key is valid
- Verify required fields are provided
```

## Summary

MCP integration enables:
- **Direct access** to prompts from AI assistants
- **Search and discovery** within conversations
- **Variable filling** with elicitation support
- **Prompt saving** from conversations
- **AI enhancement** of basic prompts

Set up once, use prompts everywhere your AI assistant goes.
