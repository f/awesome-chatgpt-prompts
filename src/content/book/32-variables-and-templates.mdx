Variables make prompts reusable and customizable. This chapter covers the variable system in prompts.chat and how to build effective templates.

## Variable Syntax

### Basic Variables

```
\${variable_name}
```

Example:
```
Write a \${length} word article about ${topic}.
```

### Variables with Defaults

```
\${variable_name:default value}
```

Example:
```
Write a \${length:500} word article about \${topic:technology trends}.
```

If not provided, uses the default value.

### Variable Naming

```
Conventions:
- Use snake_case: \${user_name}, \${word_count}
- Be descriptive: \${target_audience} not \${ta}
- Keep concise: \${topic} not \${the_main_topic_to_write_about}

Valid characters:
- Letters (a-z, A-Z)
- Numbers (0-9)
- Underscores (_)

Invalid:
- Spaces: \${user name} ❌
- Hyphens: \${user-name} ❌
- Special chars: \${user@name} ❌
```

## Using Variables

### In prompts.chat UI

When viewing a prompt with variables:
1. Variable input fields appear
2. Fill in your values
3. Preview shows filled prompt
4. Copy the customized version

### Programmatic Filling

```typescript
import { PromptsClient } from 'prompts.chat';

const client = new PromptsClient({ apiKey: 'your-key' });

// Get prompt
const prompt = await client.prompts.get('prompt-id');

// Fill variables
const filled = prompt.fill({
  topic: "machine learning",
  length: "1000",
  audience: "beginners"
});

console.log(filled);
```

### MCP Variable Elicitation

When using MCP, if a prompt has required variables:

```typescript
// get_prompt tool response
{
  "variablesRequired": [
    {
      "name": "topic",
      "description": "The main topic to write about",
      "required": true
    },
    {
      "name": "length",
      "description": "Target word count",
      "required": false,
      "default": "500"
    }
  ],
  "message": "Please provide values for the required variables"
}

// AI assistant asks user for values
// Then calls get_prompt again with variables filled
```

## Template Design Patterns

### The Flexible Template

Build templates that work for many variations:

```
You are a \${role:helpful assistant} specializing in \${specialty:general topics}.

Your communication style is \${tone:professional and friendly}.

Help the user with: \${task}

Guidelines:
- \${guideline_1:Be clear and concise}
- \${guideline_2:Provide examples when helpful}
- \${guideline_3:Ask clarifying questions if needed}

Output format: \${format:conversational text}
```

### The Structured Template

For consistent, parseable output:

```
Analyze the \${content_type:text} and extract information.

Input:
\${input}

Return JSON with this structure:
{
  "summary": "string - brief summary",
  "category": "\${categories:general|technical|creative}",
  "sentiment": "positive|negative|neutral",
  "key_points": ["array of main points"],
  "confidence": 0.0-1.0
}

Focus particularly on: \${focus_area:overall analysis}
```

### The Conditional Template

Using variables to switch behavior:

```
You are a \${role} assistant.

\${#if expertise}
You have deep expertise in: \${expertise}
\${/if}

Task: \${task}

\${#if constraints}
Important constraints:
\${constraints}
\${/if}

\${#if examples}
Examples of good output:
\${examples}
\${/if}

Respond in \${language:English}.
```

Note: Conditional syntax varies by implementation. Basic prompts.chat uses simple variable substitution; advanced conditionals require SDK processing.

## Building Reusable Templates

### Template Library Structure

```
templates/
├── writing/
│   ├── blog-post.md
│   ├── email.md
│   └── social-media.md
├── coding/
│   ├── code-review.md
│   ├── documentation.md
│   └── debugging.md
├── analysis/
│   ├── data-analysis.md
│   ├── research.md
│   └── comparison.md
└── base/
    ├── expert-role.md
    └── structured-output.md
```

### Base Templates

Create reusable bases:

```markdown
<!-- base/expert-role.md -->
You are a \${expertise_level:senior} \${profession} with 
\${years_experience:10+} years of experience in \${domain}.

Your approach:
- \${approach_1:Thorough and methodical}
- \${approach_2:Clear communication}
- \${approach_3:Best practices focused}
```

### Composed Templates

Build on bases:

```markdown
<!-- coding/code-review.md -->
\${include:base/expert-role.md}

profession: Software Engineer
domain: code quality and review

Task: Review the following \${language:Python} code.

Review criteria:
- Correctness: bugs and logic errors
- Security: vulnerabilities and risks
- Performance: efficiency concerns
- Style: \${style_guide:PEP 8} compliance
- Maintainability: readability and structure

Code to review:
```\${language}
\${code}
```

Provide your review in this format:
## Summary
## Issues Found
## Recommendations
## Positive Notes
```

## Variable Documentation

### Inline Documentation

```
Write about topic.
# topic: The main subject to cover (required)

Target length: \$\{word_count:500\} words.
# word_count: Target word count, default 500

Audience: \$\{audience:general readers\}
# audience: Who will read this, affects vocabulary and depth
```

### Structured Documentation

```yaml
# prompt-metadata.yaml
variables:
  - name: topic
    type: string
    required: true
    description: The main subject to write about
    examples:
      - "artificial intelligence"
      - "climate change"
      - "remote work trends"
  
  - name: word_count
    type: number
    required: false
    default: 500
    description: Target word count
    min: 100
    max: 5000
  
  - name: audience
    type: string
    required: false
    default: "general readers"
    description: Target audience
    options:
      - "general readers"
      - "technical experts"
      - "business executives"
      - "students"
```

## Advanced Variable Techniques

### Variable Validation

```typescript
// SDK validation
const template = new PromptTemplate(promptContent);

const validation = template.validate({
  topic: "AI",
  word_count: "not a number"  // Invalid
});

// validation.errors = ["word_count must be a number"]
```

### Variable Transformation

```typescript
// Transform values before filling
const filled = template.fill({
  topic: "machine learning",
  tags: ["AI", "ML", "tech"]  // Array transformed to comma-separated
}, {
  transforms: {
    tags: (arr) => arr.join(", ")
  }
});
```

### Nested Variables

```
Create a \${output_type} about \${topic}.

\${#switch output_type}
  \${case:blog_post}
    Structure with introduction, \${section_count:3} main sections, 
    and conclusion.
  \${case:social_media}
    Keep under \${char_limit:280} characters with hashtags.
  \${case:email}
    Use \${tone:professional} tone with clear call-to-action.
\${/switch}
```

## Template Testing

### Test Cases

```typescript
// template.test.ts
describe('Blog Post Template', () => {
  const template = loadTemplate('writing/blog-post.md');
  
  test('fills required variables', () => {
    const result = template.fill({ topic: 'AI' });
    expect(result).toContain('AI');
    expect(result).not.toContain('\${topic}');
  });
  
  test('uses defaults for optional variables', () => {
    const result = template.fill({ topic: 'AI' });
    expect(result).toContain('500');  // default word count
  });
  
  test('validates required variables', () => {
    expect(() => template.fill({})).toThrow('topic is required');
  });
});
```

### Quality Checklist

```
Template QA checklist:
□ All variables have clear names
□ Required variables are documented
□ Defaults are sensible
□ Template works with only required vars
□ Template works with all vars filled
□ Edge cases handled (empty strings, etc.)
□ Output format is consistent
□ No orphaned variable references
```

## Best Practices

### Do's

```
✓ Use descriptive variable names
✓ Provide sensible defaults
✓ Document what each variable does
✓ Test with various inputs
✓ Keep variable count manageable (under 10)
✓ Group related variables logically
```

### Don'ts

```
✗ Use ambiguous variable names
✗ Require too many variables
✗ Forget to handle missing optionals
✗ Put defaults that don't make sense
✗ Create overly complex nesting
✗ Skip validation for user inputs
```

## Summary

Variables and templates enable:
- **Reusability** — Write once, use many times
- **Customization** — Adapt to specific needs
- **Consistency** — Same structure, different content
- **Efficiency** — Quick prompt generation

Build a template library for your common use cases and iterate based on usage.
